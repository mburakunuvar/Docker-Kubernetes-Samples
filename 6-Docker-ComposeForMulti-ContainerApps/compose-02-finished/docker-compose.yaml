version: "3.8"
services:
  mongodb:
    # to replace autogenerated names by default: foldername_mongodb_1
    # container_name: mongodb
    image: "mongo"
    volumes:
      - data:/data/db
    # environment :
    # opt1 : key value pairs create yaml object by default
    #   MONGO_INITDB_ROOT_USERNAME: max
    #   MONGO_INITDB_ROOT_PASSWORD: secret
    # opt2 : list of single values will require -
    # - MONGO_INITDB_ROOT_USERNAME=max
    # opt3 : using a file
    env_file:
      - ./env/mongo.env
    # networks:
    # not necessary as docker-compose creates another by default
  backend:
    build: ./backend
    # build:
    #   context: ./backend
    #   dockerfile: Dockerfile
    #   args:
    #     some-arg: 1
    ports:
      - "80:80"
      - "3000:80" # it's also possible to list multiple ports
    volumes:
      - logs:/app/logs
      - ./backend:/app
      - /app/node_modules
    env_file:
      - ./env/backend.env
    depends_on:
      - mongodb
  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    volumes:
      - ./frontend/src:/app/src
    # in order to open input connection and replace -it flag
    stdin_open: true #i flag
    tty: true #t flag
    depends_on:
      - backend

volumes: # required for being aware about named volumes
  #different containers can use the same volume - same folder on your local
  #bind or anonymous named volumes can't be added here,indeed that's not even necessary
  data:
  logs:
